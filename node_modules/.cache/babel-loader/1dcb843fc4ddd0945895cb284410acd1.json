{"ast":null,"code":"import _regeneratorRuntime from \"/Users/weihangzhang/Documents/webpage/visualization-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/weihangzhang/Documents/webpage/visualization-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { isString, hasOwnProperty, error, truthy, constant, extend, array, isObject, isArray, toSet, debounce, isDate, inherits, stringValue } from 'vega-util';\nimport { changeset, isChangeSet, EventStream, transforms, Dataflow, asyncCallback } from 'vega-dataflow';\nimport { point, renderModule, CanvasHandler, RenderType, Scenegraph } from 'vega-scenegraph';\nimport { tickStep } from 'd3-array';\nimport { functionContext } from 'vega-functions';\nimport { context } from 'vega-runtime';\nimport { interval } from 'd3-timer';\nimport { locale } from 'vega-format';\n\n// initialize aria role and label attributes\nfunction initializeAria(view) {\n  var el = view.container();\n  if (el) {\n    el.setAttribute('role', 'graphics-document');\n    el.setAttribute('aria-roleDescription', 'visualization');\n    ariaLabel(el, view.description());\n  }\n} // update aria-label if we have a DOM container element\n\nfunction ariaLabel(el, desc) {\n  if (el) desc == null ? el.removeAttribute('aria-label') : el.setAttribute('aria-label', desc);\n}\nfunction background(view) {\n  // respond to background signal\n  view.add(null, function (_) {\n    view._background = _.bg;\n    view._resize = 1;\n    return _.bg;\n  }, {\n    bg: view._signals.background\n  });\n}\nvar Default = 'default';\nfunction cursor(view) {\n  // get cursor signal, add to dataflow if needed\n  var cursor = view._signals.cursor || (view._signals.cursor = view.add({\n    user: Default,\n    item: null\n  })); // evaluate cursor on each mousemove event\n\n  view.on(view.events('view', 'mousemove'), cursor, function (_, event) {\n    var value = cursor.value,\n      user = value ? isString(value) ? value : value.user : Default,\n      item = event.item && event.item.cursor || null;\n    return value && user === value.user && item == value.item ? value : {\n      user: user,\n      item: item\n    };\n  }); // when cursor signal updates, set visible cursor\n\n  view.add(null, function (_) {\n    var user = _.cursor,\n      item = this.value;\n    if (!isString(user)) {\n      item = user.item;\n      user = user.user;\n    }\n    setCursor(view, user && user !== Default ? user : item || user);\n    return item;\n  }, {\n    cursor: cursor\n  });\n}\nfunction setCursor(view, cursor) {\n  var el = view.globalCursor() ? typeof document !== 'undefined' && document.body : view.container();\n  if (el) {\n    return cursor == null ? el.style.removeProperty('cursor') : el.style.cursor = cursor;\n  }\n}\nfunction dataref(view, name) {\n  var data = view._runtime.data;\n  if (!hasOwnProperty(data, name)) {\n    error('Unrecognized data set: ' + name);\n  }\n  return data[name];\n}\nfunction data(name, values) {\n  return arguments.length < 2 ? dataref(this, name).values.value : change.call(this, name, changeset().remove(truthy).insert(values));\n}\nfunction change(name, changes) {\n  if (!isChangeSet(changes)) {\n    error('Second argument to changes must be a changeset.');\n  }\n  var dataset = dataref(this, name);\n  dataset.modified = true;\n  return this.pulse(dataset.input, changes);\n}\nfunction insert(name, _) {\n  return change.call(this, name, changeset().insert(_));\n}\nfunction remove(name, _) {\n  return change.call(this, name, changeset().remove(_));\n}\nfunction width(view) {\n  var padding = view.padding();\n  return Math.max(0, view._viewWidth + padding.left + padding.right);\n}\nfunction height(view) {\n  var padding = view.padding();\n  return Math.max(0, view._viewHeight + padding.top + padding.bottom);\n}\nfunction offset(view) {\n  var padding = view.padding(),\n    origin = view._origin;\n  return [padding.left + origin[0], padding.top + origin[1]];\n}\nfunction resizeRenderer(view) {\n  var origin = offset(view),\n    w = width(view),\n    h = height(view);\n  view._renderer.background(view.background());\n  view._renderer.resize(w, h, origin);\n  view._handler.origin(origin);\n  view._resizeListeners.forEach(function (handler) {\n    try {\n      handler(w, h);\n    } catch (error) {\n      view.error(error);\n    }\n  });\n}\n\n/**\n * Extend an event with additional view-specific methods.\n * Adds a new property ('vega') to an event that provides a number\n * of methods for querying information about the current interaction.\n * The vega object provides the following methods:\n *   view - Returns the backing View instance.\n *   item - Returns the currently active scenegraph item (if any).\n *   group - Returns the currently active scenegraph group (if any).\n *     This method accepts a single string-typed argument indicating the name\n *     of the desired parent group. The scenegraph will be traversed from\n *     the item up towards the root to search for a matching group. If no\n *     argument is provided the enclosing group for the active item is\n *     returned, unless the item it itself a group, in which case it is\n *     returned directly.\n *   xy - Returns a two-element array containing the x and y coordinates for\n *     mouse or touch events. For touch events, this is based on the first\n *     elements in the changedTouches array. This method accepts a single\n *     argument: either an item instance or mark name that should serve as\n *     the reference coordinate system. If no argument is provided the\n *     top-level view coordinate system is assumed.\n *   x - Returns the current x-coordinate, accepts the same arguments as xy.\n *   y - Returns the current y-coordinate, accepts the same arguments as xy.\n * @param {Event} event - The input event to extend.\n * @param {Item} item - The currently active scenegraph item (if any).\n * @return {Event} - The extended input event.\n */\n\nfunction eventExtend(view, event, item) {\n  var r = view._renderer,\n    el = r && r.canvas(),\n    p,\n    e,\n    translate;\n  if (el) {\n    translate = offset(view);\n    e = event.changedTouches ? event.changedTouches[0] : event;\n    p = point(e, el);\n    p[0] -= translate[0];\n    p[1] -= translate[1];\n  }\n  event.dataflow = view;\n  event.item = item;\n  event.vega = extension(view, item, p);\n  return event;\n}\nfunction extension(view, item, point) {\n  var itemGroup = item ? item.mark.marktype === 'group' ? item : item.mark.group : null;\n  function group(name) {\n    var g = itemGroup,\n      i;\n    if (name) for (i = item; i; i = i.mark.group) {\n      if (i.mark.name === name) {\n        g = i;\n        break;\n      }\n    }\n    return g && g.mark && g.mark.interactive ? g : {};\n  }\n  function xy(item) {\n    if (!item) return point;\n    if (isString(item)) item = group(item);\n    var p = point.slice();\n    while (item) {\n      p[0] -= item.x || 0;\n      p[1] -= item.y || 0;\n      item = item.mark && item.mark.group;\n    }\n    return p;\n  }\n  return {\n    view: constant(view),\n    item: constant(item || {}),\n    group: group,\n    xy: xy,\n    x: function x(item) {\n      return xy(item)[0];\n    },\n    y: function y(item) {\n      return xy(item)[1];\n    }\n  };\n}\nvar VIEW = 'view',\n  TIMER = 'timer',\n  WINDOW = 'window',\n  NO_TRAP = {\n    trap: false\n  };\n/**\n * Initialize event handling configuration.\n * @param {object} config - The configuration settings.\n * @return {object}\n */\n\nfunction initializeEventConfig(config) {\n  var events = extend({\n    defaults: {}\n  }, config);\n  var unpack = function unpack(obj, keys) {\n    keys.forEach(function (k) {\n      if (isArray(obj[k])) obj[k] = toSet(obj[k]);\n    });\n  };\n  unpack(events.defaults, ['prevent', 'allow']);\n  unpack(events, ['view', 'window', 'selector']);\n  return events;\n}\nfunction trackEventListener(view, sources, type, handler) {\n  view._eventListeners.push({\n    type: type,\n    sources: array(sources),\n    handler: handler\n  });\n}\nfunction prevent(view, type) {\n  var def = view._eventConfig.defaults,\n    prevent = def.prevent,\n    allow = def.allow;\n  return prevent === false || allow === true ? false : prevent === true || allow === false ? true : prevent ? prevent[type] : allow ? !allow[type] : view.preventDefault();\n}\nfunction permit(view, key, type) {\n  var rule = view._eventConfig && view._eventConfig[key];\n  if (rule === false || isObject(rule) && !rule[type]) {\n    view.warn(\"Blocked \".concat(key, \" \").concat(type, \" event listener.\"));\n    return false;\n  }\n  return true;\n}\n/**\n * Create a new event stream from an event source.\n * @param {object} source - The event source to monitor.\n * @param {string} type - The event type.\n * @param {function(object): boolean} [filter] - Event filter function.\n * @return {EventStream}\n */\n\nfunction events(source, type, filter) {\n  var view = this,\n    s = new EventStream(filter),\n    send = function send(e, item) {\n      view.runAsync(null, function () {\n        if (source === VIEW && prevent(view, type)) {\n          e.preventDefault();\n        }\n        s.receive(eventExtend(view, e, item));\n      });\n    },\n    sources;\n  if (source === TIMER) {\n    if (permit(view, 'timer', type)) {\n      view.timer(send, type);\n    }\n  } else if (source === VIEW) {\n    if (permit(view, 'view', type)) {\n      // send traps errors, so use {trap: false} option\n      view.addEventListener(type, send, NO_TRAP);\n    }\n  } else {\n    if (source === WINDOW) {\n      if (permit(view, 'window', type) && typeof window !== 'undefined') {\n        sources = [window];\n      }\n    } else if (typeof document !== 'undefined') {\n      if (permit(view, 'selector', type)) {\n        sources = document.querySelectorAll(source);\n      }\n    }\n    if (!sources) {\n      view.warn('Can not resolve event source: ' + source);\n    } else {\n      for (var i = 0, n = sources.length; i < n; ++i) {\n        sources[i].addEventListener(type, send);\n      }\n      trackEventListener(view, sources, type, send);\n    }\n  }\n  return s;\n}\nfunction itemFilter(event) {\n  return event.item;\n}\nfunction markTarget(event) {\n  // grab upstream collector feeding the mark operator\n  return event.item.mark.source;\n}\nfunction invoke(name) {\n  return function (_, event) {\n    return event.vega.view().changeset().encode(event.item, name);\n  };\n}\nfunction hover(hoverSet, leaveSet) {\n  hoverSet = [hoverSet || 'hover'];\n  leaveSet = [leaveSet || 'update', hoverSet[0]]; // invoke hover set upon mouseover\n\n  this.on(this.events('view', 'mouseover', itemFilter), markTarget, invoke(hoverSet)); // invoke leave set upon mouseout\n\n  this.on(this.events('view', 'mouseout', itemFilter), markTarget, invoke(leaveSet));\n  return this;\n}\n\n/**\n * Finalize a View instance that is being removed.\n * Cancel any running timers.\n * Remove all external event listeners.\n * Remove any currently displayed tooltip.\n */\nfunction finalize() {\n  var tooltip = this._tooltip,\n    timers = this._timers,\n    listeners = this._eventListeners,\n    n,\n    m,\n    e;\n  n = timers.length;\n  while (--n >= 0) {\n    timers[n].stop();\n  }\n  n = listeners.length;\n  while (--n >= 0) {\n    e = listeners[n];\n    m = e.sources.length;\n    while (--m >= 0) {\n      e.sources[m].removeEventListener(e.type, e.handler);\n    }\n  }\n  if (tooltip) {\n    tooltip.call(this, this._handler, null, null, null);\n  }\n  return this;\n}\nfunction element(tag, attr, text) {\n  var el = document.createElement(tag);\n  for (var key in attr) {\n    el.setAttribute(key, attr[key]);\n  }\n  if (text != null) el.textContent = text;\n  return el;\n}\nvar BindClass = 'vega-bind',\n  NameClass = 'vega-bind-name',\n  RadioClass = 'vega-bind-radio';\n/**\n * Bind a signal to an external HTML input element. The resulting two-way\n * binding will propagate input changes to signals, and propagate signal\n * changes to the input element state. If this view instance has no parent\n * element, we assume the view is headless and no bindings are created.\n * @param {Element|string} el - The parent DOM element to which the input\n *   element should be appended as a child. If string-valued, this argument\n *   will be treated as a CSS selector. If null or undefined, the parent\n *   element of this view will be used as the element.\n * @param {object} param - The binding parameters which specify the signal\n *   to bind to, the input element type, and type-specific configuration.\n * @return {View} - This view instance.\n */\n\nfunction bind(view, el, binding) {\n  if (!el) return;\n  var param = binding.param;\n  var bind = binding.state;\n  if (!bind) {\n    bind = binding.state = {\n      elements: null,\n      active: false,\n      set: null,\n      update: function update(value) {\n        if (value != view.signal(param.signal)) {\n          view.runAsync(null, function () {\n            bind.source = true;\n            view.signal(param.signal, value);\n          });\n        }\n      }\n    };\n    if (param.debounce) {\n      bind.update = debounce(param.debounce, bind.update);\n    }\n  }\n  var create = param.input == null && param.element ? target : generate;\n  create(bind, el, param, view);\n  if (!bind.active) {\n    view.on(view._signals[param.signal], null, function () {\n      bind.source ? bind.source = false : bind.set(view.signal(param.signal));\n    });\n    bind.active = true;\n  }\n  return bind;\n}\n/**\n * Bind the signal to an external EventTarget.\n */\n\nfunction target(bind, node, param, view) {\n  var type = param.event || 'input';\n  var handler = function handler() {\n    return bind.update(node.value);\n  }; // initialize signal value to external input value\n\n  view.signal(param.signal, node.value); // listen for changes on the element\n\n  node.addEventListener(type, handler); // register with view, so we can remove it upon finalization\n\n  trackEventListener(view, node, type, handler); // propagate change to element\n\n  bind.set = function (value) {\n    node.value = value;\n    node.dispatchEvent(event(type));\n  };\n}\nfunction event(type) {\n  return typeof Event !== 'undefined' ? new Event(type) : {\n    type: type\n  };\n}\n/**\n * Generate an HTML input form element and bind it to a signal.\n */\n\nfunction generate(bind, el, param, view) {\n  var value = view.signal(param.signal);\n  var div = element('div', {\n    'class': BindClass\n  });\n  var wrapper = param.input === 'radio' ? div : div.appendChild(element('label'));\n  wrapper.appendChild(element('span', {\n    'class': NameClass\n  }, param.name || param.signal));\n  el.appendChild(div);\n  var input = form;\n  switch (param.input) {\n    case 'checkbox':\n      input = checkbox;\n      break;\n    case 'select':\n      input = select;\n      break;\n    case 'radio':\n      input = radio;\n      break;\n    case 'range':\n      input = range;\n      break;\n  }\n  input(bind, wrapper, param, value);\n}\n/**\n * Generates an arbitrary input form element.\n * The input type is controlled via user-provided parameters.\n */\n\nfunction form(bind, el, param, value) {\n  var node = element('input');\n  for (var key in param) {\n    if (key !== 'signal' && key !== 'element') {\n      node.setAttribute(key === 'input' ? 'type' : key, param[key]);\n    }\n  }\n  node.setAttribute('name', param.signal);\n  node.value = value;\n  el.appendChild(node);\n  node.addEventListener('input', function () {\n    return bind.update(node.value);\n  });\n  bind.elements = [node];\n  bind.set = function (value) {\n    return node.value = value;\n  };\n}\n/**\n * Generates a checkbox input element.\n */\n\nfunction checkbox(bind, el, param, value) {\n  var attr = {\n    type: 'checkbox',\n    name: param.signal\n  };\n  if (value) attr.checked = true;\n  var node = element('input', attr);\n  el.appendChild(node);\n  node.addEventListener('change', function () {\n    return bind.update(node.checked);\n  });\n  bind.elements = [node];\n  bind.set = function (value) {\n    return node.checked = !!value || null;\n  };\n}\n/**\n * Generates a selection list input element.\n */\n\nfunction select(bind, el, param, value) {\n  var node = element('select', {\n      name: param.signal\n    }),\n    labels = param.labels || [];\n  param.options.forEach(function (option, i) {\n    var attr = {\n      value: option\n    };\n    if (valuesEqual(option, value)) attr.selected = true;\n    node.appendChild(element('option', attr, (labels[i] || option) + ''));\n  });\n  el.appendChild(node);\n  node.addEventListener('change', function () {\n    bind.update(param.options[node.selectedIndex]);\n  });\n  bind.elements = [node];\n  bind.set = function (value) {\n    for (var i = 0, n = param.options.length; i < n; ++i) {\n      if (valuesEqual(param.options[i], value)) {\n        node.selectedIndex = i;\n        return;\n      }\n    }\n  };\n}\n/**\n * Generates a radio button group.\n */\n\nfunction radio(bind, el, param, value) {\n  var group = element('span', {\n      'class': RadioClass\n    }),\n    labels = param.labels || [];\n  el.appendChild(group);\n  bind.elements = param.options.map(function (option, i) {\n    var attr = {\n      type: 'radio',\n      name: param.signal,\n      value: option\n    };\n    if (valuesEqual(option, value)) attr.checked = true;\n    var input = element('input', attr);\n    input.addEventListener('change', function () {\n      return bind.update(option);\n    });\n    var label = element('label', {}, (labels[i] || option) + '');\n    label.prepend(input);\n    group.appendChild(label);\n    return input;\n  });\n  bind.set = function (value) {\n    var nodes = bind.elements,\n      n = nodes.length;\n    for (var i = 0; i < n; ++i) {\n      if (valuesEqual(nodes[i].value, value)) nodes[i].checked = true;\n    }\n  };\n}\n/**\n * Generates a slider input element.\n */\n\nfunction range(bind, el, param, value) {\n  value = value !== undefined ? value : (+param.max + +param.min) / 2;\n  var max = param.max != null ? param.max : Math.max(100, +value) || 100,\n    min = param.min || Math.min(0, max, +value) || 0,\n    step = param.step || tickStep(min, max, 100);\n  var node = element('input', {\n    type: 'range',\n    name: param.signal,\n    min: min,\n    max: max,\n    step: step\n  });\n  node.value = value;\n  var span = element('span', {}, +value);\n  el.appendChild(node);\n  el.appendChild(span);\n  var update = function update() {\n    span.textContent = node.value;\n    bind.update(+node.value);\n  }; // subscribe to both input and change\n\n  node.addEventListener('input', update);\n  node.addEventListener('change', update);\n  bind.elements = [node];\n  bind.set = function (value) {\n    node.value = value;\n    span.textContent = value;\n  };\n}\nfunction valuesEqual(a, b) {\n  return a === b || a + '' === b + '';\n}\nfunction initializeRenderer(view, r, el, constructor, scaleFactor, opt) {\n  r = r || new constructor(view.loader());\n  return r.initialize(el, width(view), height(view), offset(view), scaleFactor, opt).background(view.background());\n}\nfunction trap(view, fn) {\n  return !fn ? null : function () {\n    try {\n      fn.apply(this, arguments);\n    } catch (error) {\n      view.error(error);\n    }\n  };\n}\nfunction initializeHandler(view, prevHandler, el, constructor) {\n  // instantiate scenegraph handler\n  var handler = new constructor(view.loader(), trap(view, view.tooltip())).scene(view.scenegraph().root).initialize(el, offset(view), view); // transfer event handlers\n\n  if (prevHandler) {\n    prevHandler.handlers().forEach(function (h) {\n      handler.on(h.type, h.handler);\n    });\n  }\n  return handler;\n}\nfunction initialize(el, elBind) {\n  var view = this,\n    type = view._renderType,\n    config = view._eventConfig.bind,\n    module = renderModule(type); // containing dom element\n\n  el = view._el = el ? lookup(view, el, true) : null; // initialize aria attributes\n\n  initializeAria(view); // select appropriate renderer & handler\n\n  if (!module) view.error('Unrecognized renderer type: ' + type);\n  var Handler = module.handler || CanvasHandler,\n    Renderer = el ? module.renderer : module.headless; // initialize renderer and input handler\n\n  view._renderer = !Renderer ? null : initializeRenderer(view, view._renderer, el, Renderer);\n  view._handler = initializeHandler(view, view._handler, el, Handler);\n  view._redraw = true; // initialize signal bindings\n\n  if (el && config !== 'none') {\n    elBind = elBind ? view._elBind = lookup(view, elBind, true) : el.appendChild(element('form', {\n      'class': 'vega-bindings'\n    }));\n    view._bind.forEach(function (_) {\n      if (_.param.element && config !== 'container') {\n        _.element = lookup(view, _.param.element, !!_.param.input);\n      }\n    });\n    view._bind.forEach(function (_) {\n      bind(view, _.element || elBind, _);\n    });\n  }\n  return view;\n}\nfunction lookup(view, el, clear) {\n  if (typeof el === 'string') {\n    if (typeof document !== 'undefined') {\n      el = document.querySelector(el);\n      if (!el) {\n        view.error('Signal bind element not found: ' + el);\n        return null;\n      }\n    } else {\n      view.error('DOM document instance not found.');\n      return null;\n    }\n  }\n  if (el && clear) {\n    try {\n      el.textContent = '';\n    } catch (e) {\n      el = null;\n      view.error(e);\n    }\n  }\n  return el;\n}\nvar number = function number(_) {\n  return +_ || 0;\n};\nvar paddingObject = function paddingObject(_) {\n  return {\n    top: _,\n    bottom: _,\n    left: _,\n    right: _\n  };\n};\nfunction _padding(_) {\n  return isObject(_) ? {\n    top: number(_.top),\n    bottom: number(_.bottom),\n    left: number(_.left),\n    right: number(_.right)\n  } : paddingObject(number(_));\n}\n\n/**\n * Render the current scene in a headless fashion.\n * This method is asynchronous, returning a Promise instance.\n * @return {Promise} - A Promise that resolves to a renderer.\n */\nfunction renderHeadless(_x, _x2, _x3, _x4) {\n  return _renderHeadless.apply(this, arguments);\n}\n/**\n * Produce an image URL for the visualization. Depending on the type\n * parameter, the generated URL contains data for either a PNG or SVG image.\n * The URL can be used (for example) to download images of the visualization.\n * This method is asynchronous, returning a Promise instance.\n * @param {string} type - The image type. One of 'svg', 'png' or 'canvas'.\n *   The 'canvas' and 'png' types are synonyms for a PNG image.\n * @return {Promise} - A promise that resolves to an image URL.\n */\nfunction _renderHeadless() {\n  _renderHeadless = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(view, type, scaleFactor, opt) {\n    var module, ctr;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            module = renderModule(type), ctr = module && module.headless;\n            if (!ctr) error('Unrecognized renderer type: ' + type);\n            _context2.next = 4;\n            return view.runAsync();\n          case 4:\n            return _context2.abrupt(\"return\", initializeRenderer(view, null, null, ctr, scaleFactor, opt).renderAsync(view._scenegraph.root));\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _renderHeadless.apply(this, arguments);\n}\nfunction renderToImageURL(_x5, _x6) {\n  return _renderToImageURL.apply(this, arguments);\n}\nfunction _renderToImageURL() {\n  _renderToImageURL = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(type, scaleFactor) {\n    var r;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (type !== RenderType.Canvas && type !== RenderType.SVG && type !== RenderType.PNG) {\n              error('Unrecognized image type: ' + type);\n            }\n            _context3.next = 3;\n            return renderHeadless(this, type, scaleFactor);\n          case 3:\n            r = _context3.sent;\n            return _context3.abrupt(\"return\", type === RenderType.SVG ? toBlobURL(r.svg(), 'image/svg+xml') : r.canvas().toDataURL('image/png'));\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, this);\n  }));\n  return _renderToImageURL.apply(this, arguments);\n}\nfunction toBlobURL(data, mime) {\n  var blob = new Blob([data], {\n    type: mime\n  });\n  return window.URL.createObjectURL(blob);\n}\n\n/**\n * Produce a Canvas instance containing a rendered visualization.\n * This method is asynchronous, returning a Promise instance.\n * @return {Promise} - A promise that resolves to a Canvas instance.\n */\nfunction renderToCanvas(_x7, _x8) {\n  return _renderToCanvas.apply(this, arguments);\n}\n/**\n * Produce a rendered SVG string of the visualization.\n * This method is asynchronous, returning a Promise instance.\n * @return {Promise} - A promise that resolves to an SVG string.\n */\nfunction _renderToCanvas() {\n  _renderToCanvas = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(scaleFactor, opt) {\n    var r;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return renderHeadless(this, RenderType.Canvas, scaleFactor, opt);\n          case 2:\n            r = _context4.sent;\n            return _context4.abrupt(\"return\", r.canvas());\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, this);\n  }));\n  return _renderToCanvas.apply(this, arguments);\n}\nfunction renderToSVG(_x9) {\n  return _renderToSVG.apply(this, arguments);\n}\nfunction _renderToSVG() {\n  _renderToSVG = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(scaleFactor) {\n    var r;\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return renderHeadless(this, RenderType.SVG, scaleFactor);\n          case 2:\n            r = _context5.sent;\n            return _context5.abrupt(\"return\", r.svg());\n          case 4:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, this);\n  }));\n  return _renderToSVG.apply(this, arguments);\n}\nfunction runtime(view, spec, expr) {\n  return context(view, transforms, functionContext, expr).parse(spec);\n}\nfunction scale(name) {\n  var scales = this._runtime.scales;\n  if (!hasOwnProperty(scales, name)) {\n    error('Unrecognized scale or projection: ' + name);\n  }\n  return scales[name].value;\n}\nvar Width = 'width',\n  Height = 'height',\n  Padding = 'padding',\n  Skip = {\n    skip: true\n  };\nfunction viewWidth(view, width) {\n  var a = view.autosize(),\n    p = view.padding();\n  return width - (a && a.contains === Padding ? p.left + p.right : 0);\n}\nfunction viewHeight(view, height) {\n  var a = view.autosize(),\n    p = view.padding();\n  return height - (a && a.contains === Padding ? p.top + p.bottom : 0);\n}\nfunction initializeResize(view) {\n  var s = view._signals,\n    w = s[Width],\n    h = s[Height],\n    p = s[Padding];\n  function resetSize() {\n    view._autosize = view._resize = 1;\n  } // respond to width signal\n\n  view._resizeWidth = view.add(null, function (_) {\n    view._width = _.size;\n    view._viewWidth = viewWidth(view, _.size);\n    resetSize();\n  }, {\n    size: w\n  }); // respond to height signal\n\n  view._resizeHeight = view.add(null, function (_) {\n    view._height = _.size;\n    view._viewHeight = viewHeight(view, _.size);\n    resetSize();\n  }, {\n    size: h\n  }); // respond to padding signal\n\n  var resizePadding = view.add(null, resetSize, {\n    pad: p\n  }); // set rank to run immediately after source signal\n\n  view._resizeWidth.rank = w.rank + 1;\n  view._resizeHeight.rank = h.rank + 1;\n  resizePadding.rank = p.rank + 1;\n}\nfunction resizeView(viewWidth, viewHeight, width, height, origin, auto) {\n  this.runAfter(function (view) {\n    var rerun = 0; // reset autosize flag\n\n    view._autosize = 0; // width value changed: update signal, skip resize op\n\n    if (view.width() !== width) {\n      rerun = 1;\n      view.signal(Width, width, Skip); // set width, skip update calc\n\n      view._resizeWidth.skip(true); // skip width resize handler\n    } // height value changed: update signal, skip resize op\n\n    if (view.height() !== height) {\n      rerun = 1;\n      view.signal(Height, height, Skip); // set height, skip update calc\n\n      view._resizeHeight.skip(true); // skip height resize handler\n    } // view width changed: update view property, set resize flag\n\n    if (view._viewWidth !== viewWidth) {\n      view._resize = 1;\n      view._viewWidth = viewWidth;\n    } // view height changed: update view property, set resize flag\n\n    if (view._viewHeight !== viewHeight) {\n      view._resize = 1;\n      view._viewHeight = viewHeight;\n    } // origin changed: update view property, set resize flag\n\n    if (view._origin[0] !== origin[0] || view._origin[1] !== origin[1]) {\n      view._resize = 1;\n      view._origin = origin;\n    } // run dataflow on width/height signal change\n\n    if (rerun) view.run('enter');\n    if (auto) view.runAfter(function (v) {\n      return v.resize();\n    });\n  }, false, 1);\n}\n\n/**\n * Get the current view state, consisting of signal values and/or data sets.\n * @param {object} [options] - Options flags indicating which state to export.\n *   If unspecified, all signals and data sets will be exported.\n * @param {function(string, Operator):boolean} [options.signals] - Optional\n *   predicate function for testing if a signal should be included in the\n *   exported state. If unspecified, all signals will be included, except for\n *   those named 'parent' or those which refer to a Transform value.\n * @param {function(string, object):boolean} [options.data] - Optional\n *   predicate function for testing if a data set's input should be included\n *   in the exported state. If unspecified, all data sets that have been\n *   explicitly modified will be included.\n * @param {boolean} [options.recurse=true] - Flag indicating if the exported\n *   state should recursively include state from group mark sub-contexts.\n * @return {object} - An object containing the exported state values.\n */\n\nfunction getState(options) {\n  return this._runtime.getState(options || {\n    data: dataTest,\n    signals: signalTest,\n    recurse: true\n  });\n}\nfunction dataTest(name, data) {\n  return data.modified && isArray(data.input.value) && name.indexOf('_:vega:_');\n}\nfunction signalTest(name, op) {\n  return !(name === 'parent' || op instanceof transforms.proxy);\n}\n/**\n * Sets the current view state and updates the view by invoking run.\n * @param {object} state - A state object containing signal and/or\n *   data set values, following the format used by the getState method.\n * @return {View} - This view instance.\n */\n\nfunction setState(state) {\n  this.runAsync(null, function (v) {\n    v._trigger = false;\n    v._runtime.setState(state);\n  }, function (v) {\n    v._trigger = true;\n  });\n  return this;\n}\nfunction timer(callback, delay) {\n  function tick(elapsed) {\n    callback({\n      timestamp: Date.now(),\n      elapsed: elapsed\n    });\n  }\n  this._timers.push(interval(tick, delay));\n}\nfunction defaultTooltip(handler, event, item, value) {\n  var el = handler.element();\n  if (el) el.setAttribute('title', formatTooltip(value));\n}\nfunction formatTooltip(value) {\n  return value == null ? '' : isArray(value) ? formatArray(value) : isObject(value) && !isDate(value) ? formatObject(value) : value + '';\n}\nfunction formatObject(obj) {\n  return Object.keys(obj).map(function (key) {\n    var v = obj[key];\n    return key + ': ' + (isArray(v) ? formatArray(v) : formatValue(v));\n  }).join('\\n');\n}\nfunction formatArray(value) {\n  return '[' + value.map(formatValue).join(', ') + ']';\n}\nfunction formatValue(value) {\n  return isArray(value) ? \"[\\u2026]\" : isObject(value) && !isDate(value) ? \"{\\u2026}\" : value;\n}\n\n/**\n * Create a new View instance from a Vega dataflow runtime specification.\n * The generated View will not immediately be ready for display. Callers\n * should also invoke the initialize method (e.g., to set the parent\n * DOM element in browser-based deployment) and then invoke the run\n * method to evaluate the dataflow graph. Rendering will automatically\n * be performed upon dataflow runs.\n * @constructor\n * @param {object} spec - The Vega dataflow runtime specification.\n */\n\nfunction View(spec, options) {\n  var view = this;\n  options = options || {};\n  Dataflow.call(view);\n  if (options.loader) view.loader(options.loader);\n  if (options.logger) view.logger(options.logger);\n  if (options.logLevel != null) view.logLevel(options.logLevel);\n  if (options.locale || spec.locale) {\n    var loc = extend({}, spec.locale, options.locale);\n    view.locale(locale(loc.number, loc.time));\n  }\n  view._el = null;\n  view._elBind = null;\n  view._renderType = options.renderer || RenderType.Canvas;\n  view._scenegraph = new Scenegraph();\n  var root = view._scenegraph.root; // initialize renderer, handler and event management\n\n  view._renderer = null;\n  view._tooltip = options.tooltip || defaultTooltip, view._redraw = true;\n  view._handler = new CanvasHandler().scene(root);\n  view._globalCursor = false;\n  view._preventDefault = false;\n  view._timers = [];\n  view._eventListeners = [];\n  view._resizeListeners = []; // initialize event configuration\n\n  view._eventConfig = initializeEventConfig(spec.eventConfig);\n  view.globalCursor(view._eventConfig.globalCursor); // initialize dataflow graph\n\n  var ctx = runtime(view, spec, options.expr);\n  view._runtime = ctx;\n  view._signals = ctx.signals;\n  view._bind = (spec.bindings || []).map(function (_) {\n    return {\n      state: null,\n      param: extend({}, _)\n    };\n  }); // initialize scenegraph\n\n  if (ctx.root) ctx.root.set(root);\n  root.source = ctx.data.root.input;\n  view.pulse(ctx.data.root.input, view.changeset().insert(root.items)); // initialize view size\n\n  view._width = view.width();\n  view._height = view.height();\n  view._viewWidth = viewWidth(view, view._width);\n  view._viewHeight = viewHeight(view, view._height);\n  view._origin = [0, 0];\n  view._resize = 0;\n  view._autosize = 1;\n  initializeResize(view); // initialize background color\n\n  background(view); // initialize cursor\n\n  cursor(view); // initialize view description\n\n  view.description(spec.description); // initialize hover proessing, if requested\n\n  if (options.hover) view.hover(); // initialize DOM container(s) and renderer\n\n  if (options.container) view.initialize(options.container, options.bind);\n}\nfunction lookupSignal(view, name) {\n  return hasOwnProperty(view._signals, name) ? view._signals[name] : error('Unrecognized signal name: ' + stringValue(name));\n}\nfunction findOperatorHandler(op, handler) {\n  var h = (op._targets || []).filter(function (op) {\n    return op._update && op._update.handler === handler;\n  });\n  return h.length ? h[0] : null;\n}\nfunction addOperatorListener(view, name, op, handler) {\n  var h = findOperatorHandler(op, handler);\n  if (!h) {\n    h = trap(view, function () {\n      return handler(name, op.value);\n    });\n    h.handler = handler;\n    view.on(op, null, h);\n  }\n  return view;\n}\nfunction removeOperatorListener(view, op, handler) {\n  var h = findOperatorHandler(op, handler);\n  if (h) op._targets.remove(h);\n  return view;\n}\ninherits(View, Dataflow, {\n  // -- DATAFLOW / RENDERING ----\n  evaluate: function evaluate(encode, prerun, postrun) {\n    var _this = this;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return Dataflow.prototype.evaluate.call(_this, encode, prerun);\n            case 2:\n              if (!(_this._redraw || _this._resize)) {\n                _context.next = 14;\n                break;\n              }\n              _context.prev = 3;\n              if (!_this._renderer) {\n                _context.next = 8;\n                break;\n              }\n              if (_this._resize) {\n                _this._resize = 0;\n                resizeRenderer(_this);\n              }\n              _context.next = 8;\n              return _this._renderer.renderAsync(_this._scenegraph.root);\n            case 8:\n              _this._redraw = false;\n              _context.next = 14;\n              break;\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](3);\n              _this.error(_context.t0);\n            case 14:\n              // evaluate postrun\n\n              if (postrun) asyncCallback(_this, postrun);\n              return _context.abrupt(\"return\", _this);\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 11]]);\n    }))();\n  },\n  dirty: function dirty(item) {\n    this._redraw = true;\n    this._renderer && this._renderer.dirty(item);\n  },\n  // -- GET / SET ----\n  description: function description(text) {\n    if (arguments.length) {\n      var desc = text != null ? text + '' : null;\n      if (desc !== this._desc) ariaLabel(this._el, this._desc = desc);\n      return this;\n    }\n    return this._desc;\n  },\n  container: function container() {\n    return this._el;\n  },\n  scenegraph: function scenegraph() {\n    return this._scenegraph;\n  },\n  origin: function origin() {\n    return this._origin.slice();\n  },\n  signal: function signal(name, value, options) {\n    var op = lookupSignal(this, name);\n    return arguments.length === 1 ? op.value : this.update(op, value, options);\n  },\n  width: function width(_) {\n    return arguments.length ? this.signal('width', _) : this.signal('width');\n  },\n  height: function height(_) {\n    return arguments.length ? this.signal('height', _) : this.signal('height');\n  },\n  padding: function padding(_) {\n    return arguments.length ? this.signal('padding', _padding(_)) : _padding(this.signal('padding'));\n  },\n  autosize: function autosize(_) {\n    return arguments.length ? this.signal('autosize', _) : this.signal('autosize');\n  },\n  background: function background(_) {\n    return arguments.length ? this.signal('background', _) : this.signal('background');\n  },\n  renderer: function renderer(type) {\n    if (!arguments.length) return this._renderType;\n    if (!renderModule(type)) error('Unrecognized renderer type: ' + type);\n    if (type !== this._renderType) {\n      this._renderType = type;\n      this._resetRenderer();\n    }\n    return this;\n  },\n  tooltip: function tooltip(handler) {\n    if (!arguments.length) return this._tooltip;\n    if (handler !== this._tooltip) {\n      this._tooltip = handler;\n      this._resetRenderer();\n    }\n    return this;\n  },\n  loader: function loader(_loader) {\n    if (!arguments.length) return this._loader;\n    if (_loader !== this._loader) {\n      Dataflow.prototype.loader.call(this, _loader);\n      this._resetRenderer();\n    }\n    return this;\n  },\n  resize: function resize() {\n    // set flag to perform autosize\n    this._autosize = 1; // touch autosize signal to ensure top-level ViewLayout runs\n\n    return this.touch(lookupSignal(this, 'autosize'));\n  },\n  _resetRenderer: function _resetRenderer() {\n    if (this._renderer) {\n      this._renderer = null;\n      this.initialize(this._el, this._elBind);\n    }\n  },\n  // -- SIZING ----\n  _resizeView: resizeView,\n  // -- EVENT HANDLING ----\n  addEventListener: function addEventListener(type, handler, options) {\n    var callback = handler;\n    if (!(options && options.trap === false)) {\n      // wrap callback in error handler\n      callback = trap(this, handler);\n      callback.raw = handler;\n    }\n    this._handler.on(type, callback);\n    return this;\n  },\n  removeEventListener: function removeEventListener(type, handler) {\n    var handlers = this._handler.handlers(type),\n      i = handlers.length,\n      h,\n      t; // search registered handlers, remove if match found\n\n    while (--i >= 0) {\n      t = handlers[i].type;\n      h = handlers[i].handler;\n      if (type === t && (handler === h || handler === h.raw)) {\n        this._handler.off(t, h);\n        break;\n      }\n    }\n    return this;\n  },\n  addResizeListener: function addResizeListener(handler) {\n    var l = this._resizeListeners;\n    if (l.indexOf(handler) < 0) {\n      // add handler if it isn't already registered\n      // note: error trapping handled elsewhere, so\n      // no need to wrap handlers here\n      l.push(handler);\n    }\n    return this;\n  },\n  removeResizeListener: function removeResizeListener(handler) {\n    var l = this._resizeListeners,\n      i = l.indexOf(handler);\n    if (i >= 0) {\n      l.splice(i, 1);\n    }\n    return this;\n  },\n  addSignalListener: function addSignalListener(name, handler) {\n    return addOperatorListener(this, name, lookupSignal(this, name), handler);\n  },\n  removeSignalListener: function removeSignalListener(name, handler) {\n    return removeOperatorListener(this, lookupSignal(this, name), handler);\n  },\n  addDataListener: function addDataListener(name, handler) {\n    return addOperatorListener(this, name, dataref(this, name).values, handler);\n  },\n  removeDataListener: function removeDataListener(name, handler) {\n    return removeOperatorListener(this, dataref(this, name).values, handler);\n  },\n  globalCursor: function globalCursor(_) {\n    if (arguments.length) {\n      if (this._globalCursor !== !!_) {\n        var prev = setCursor(this, null); // clear previous cursor\n\n        this._globalCursor = !!_;\n        if (prev) setCursor(this, prev); // swap cursor\n      }\n\n      return this;\n    } else {\n      return this._globalCursor;\n    }\n  },\n  preventDefault: function preventDefault(_) {\n    if (arguments.length) {\n      this._preventDefault = _;\n      return this;\n    } else {\n      return this._preventDefault;\n    }\n  },\n  timer: timer,\n  events: events,\n  finalize: finalize,\n  hover: hover,\n  // -- DATA ----\n  data: data,\n  change: change,\n  insert: insert,\n  remove: remove,\n  // -- SCALES --\n  scale: scale,\n  // -- INITIALIZATION ----\n  initialize: initialize,\n  // -- HEADLESS RENDERING ----\n  toImageURL: renderToImageURL,\n  toCanvas: renderToCanvas,\n  toSVG: renderToSVG,\n  // -- SAVE / RESTORE STATE ----\n  getState: getState,\n  setState: setState\n});\nexport { View };","map":{"version":3,"names":["isString","hasOwnProperty","error","truthy","constant","extend","array","isObject","isArray","toSet","debounce","isDate","inherits","stringValue","changeset","isChangeSet","EventStream","transforms","Dataflow","asyncCallback","point","renderModule","CanvasHandler","RenderType","Scenegraph","tickStep","functionContext","context","interval","locale","initializeAria","view","el","container","setAttribute","ariaLabel","description","desc","removeAttribute","background","add","_","_background","bg","_resize","_signals","Default","cursor","user","item","on","events","event","value","setCursor","globalCursor","document","body","style","removeProperty","dataref","name","data","_runtime","values","arguments","length","change","call","remove","insert","changes","dataset","modified","pulse","input","width","padding","Math","max","_viewWidth","left","right","height","_viewHeight","top","bottom","offset","origin","_origin","resizeRenderer","w","h","_renderer","resize","_handler","_resizeListeners","forEach","handler","eventExtend","r","canvas","p","e","translate","changedTouches","dataflow","vega","extension","itemGroup","mark","marktype","group","g","i","interactive","xy","slice","x","y","VIEW","TIMER","WINDOW","NO_TRAP","trap","initializeEventConfig","config","defaults","unpack","obj","keys","k","trackEventListener","sources","type","_eventListeners","push","prevent","def","_eventConfig","allow","preventDefault","permit","key","rule","warn","concat","source","filter","s","send","runAsync","receive","timer","addEventListener","window","querySelectorAll","n","itemFilter","markTarget","invoke","encode","hover","hoverSet","leaveSet","finalize","tooltip","_tooltip","timers","_timers","listeners","m","stop","removeEventListener","element","tag","attr","text","createElement","textContent","BindClass","NameClass","RadioClass","bind","binding","param","state","elements","active","set","update","signal","create","target","generate","node","dispatchEvent","Event","div","wrapper","appendChild","form","checkbox","select","radio","range","checked","labels","options","option","valuesEqual","selected","selectedIndex","map","label","prepend","nodes","undefined","min","step","span","a","b","initializeRenderer","constructor","scaleFactor","opt","loader","initialize","fn","apply","initializeHandler","prevHandler","scene","scenegraph","root","handlers","elBind","_renderType","module","_el","lookup","Handler","Renderer","renderer","headless","_redraw","_elBind","_bind","clear","querySelector","number","paddingObject","renderHeadless","ctr","renderAsync","_scenegraph","renderToImageURL","Canvas","SVG","PNG","toBlobURL","svg","toDataURL","mime","blob","Blob","URL","createObjectURL","renderToCanvas","renderToSVG","runtime","spec","expr","parse","scale","scales","Width","Height","Padding","Skip","skip","viewWidth","autosize","contains","viewHeight","initializeResize","resetSize","_autosize","_resizeWidth","_width","size","_resizeHeight","_height","resizePadding","pad","rank","resizeView","auto","runAfter","rerun","run","v","getState","dataTest","signals","signalTest","recurse","indexOf","op","proxy","setState","_trigger","callback","delay","tick","elapsed","timestamp","Date","now","defaultTooltip","formatTooltip","formatArray","formatObject","Object","formatValue","join","View","logger","logLevel","loc","time","_globalCursor","_preventDefault","eventConfig","ctx","bindings","items","lookupSignal","findOperatorHandler","_targets","_update","addOperatorListener","removeOperatorListener","evaluate","prerun","postrun","prototype","dirty","_desc","_resetRenderer","_loader","touch","_resizeView","raw","t","off","addResizeListener","l","removeResizeListener","splice","addSignalListener","removeSignalListener","addDataListener","removeDataListener","prev","toImageURL","toCanvas","toSVG"],"sources":["/Users/weihangzhang/Documents/webpage/visualization-app/node_modules/vega-view/build/vega-view.module.js"],"sourcesContent":["import { isString, hasOwnProperty, error, truthy, constant, extend, array, isObject, isArray, toSet, debounce, isDate, inherits, stringValue } from 'vega-util';\nimport { changeset, isChangeSet, EventStream, transforms, Dataflow, asyncCallback } from 'vega-dataflow';\nimport { point, renderModule, CanvasHandler, RenderType, Scenegraph } from 'vega-scenegraph';\nimport { tickStep } from 'd3-array';\nimport { functionContext } from 'vega-functions';\nimport { context } from 'vega-runtime';\nimport { interval } from 'd3-timer';\nimport { locale } from 'vega-format';\n\n// initialize aria role and label attributes\nfunction initializeAria(view) {\n  const el = view.container();\n\n  if (el) {\n    el.setAttribute('role', 'graphics-document');\n    el.setAttribute('aria-roleDescription', 'visualization');\n    ariaLabel(el, view.description());\n  }\n} // update aria-label if we have a DOM container element\n\nfunction ariaLabel(el, desc) {\n  if (el) desc == null ? el.removeAttribute('aria-label') : el.setAttribute('aria-label', desc);\n}\n\nfunction background (view) {\n  // respond to background signal\n  view.add(null, _ => {\n    view._background = _.bg;\n    view._resize = 1;\n    return _.bg;\n  }, {\n    bg: view._signals.background\n  });\n}\n\nconst Default = 'default';\nfunction cursor (view) {\n  // get cursor signal, add to dataflow if needed\n  const cursor = view._signals.cursor || (view._signals.cursor = view.add({\n    user: Default,\n    item: null\n  })); // evaluate cursor on each mousemove event\n\n  view.on(view.events('view', 'mousemove'), cursor, (_, event) => {\n    const value = cursor.value,\n          user = value ? isString(value) ? value : value.user : Default,\n          item = event.item && event.item.cursor || null;\n    return value && user === value.user && item == value.item ? value : {\n      user: user,\n      item: item\n    };\n  }); // when cursor signal updates, set visible cursor\n\n  view.add(null, function (_) {\n    let user = _.cursor,\n        item = this.value;\n\n    if (!isString(user)) {\n      item = user.item;\n      user = user.user;\n    }\n\n    setCursor(view, user && user !== Default ? user : item || user);\n    return item;\n  }, {\n    cursor: cursor\n  });\n}\nfunction setCursor(view, cursor) {\n  const el = view.globalCursor() ? typeof document !== 'undefined' && document.body : view.container();\n\n  if (el) {\n    return cursor == null ? el.style.removeProperty('cursor') : el.style.cursor = cursor;\n  }\n}\n\nfunction dataref(view, name) {\n  var data = view._runtime.data;\n\n  if (!hasOwnProperty(data, name)) {\n    error('Unrecognized data set: ' + name);\n  }\n\n  return data[name];\n}\nfunction data(name, values) {\n  return arguments.length < 2 ? dataref(this, name).values.value : change.call(this, name, changeset().remove(truthy).insert(values));\n}\nfunction change(name, changes) {\n  if (!isChangeSet(changes)) {\n    error('Second argument to changes must be a changeset.');\n  }\n\n  const dataset = dataref(this, name);\n  dataset.modified = true;\n  return this.pulse(dataset.input, changes);\n}\nfunction insert(name, _) {\n  return change.call(this, name, changeset().insert(_));\n}\nfunction remove(name, _) {\n  return change.call(this, name, changeset().remove(_));\n}\n\nfunction width(view) {\n  var padding = view.padding();\n  return Math.max(0, view._viewWidth + padding.left + padding.right);\n}\nfunction height(view) {\n  var padding = view.padding();\n  return Math.max(0, view._viewHeight + padding.top + padding.bottom);\n}\nfunction offset(view) {\n  var padding = view.padding(),\n      origin = view._origin;\n  return [padding.left + origin[0], padding.top + origin[1]];\n}\nfunction resizeRenderer(view) {\n  var origin = offset(view),\n      w = width(view),\n      h = height(view);\n\n  view._renderer.background(view.background());\n\n  view._renderer.resize(w, h, origin);\n\n  view._handler.origin(origin);\n\n  view._resizeListeners.forEach(handler => {\n    try {\n      handler(w, h);\n    } catch (error) {\n      view.error(error);\n    }\n  });\n}\n\n/**\n * Extend an event with additional view-specific methods.\n * Adds a new property ('vega') to an event that provides a number\n * of methods for querying information about the current interaction.\n * The vega object provides the following methods:\n *   view - Returns the backing View instance.\n *   item - Returns the currently active scenegraph item (if any).\n *   group - Returns the currently active scenegraph group (if any).\n *     This method accepts a single string-typed argument indicating the name\n *     of the desired parent group. The scenegraph will be traversed from\n *     the item up towards the root to search for a matching group. If no\n *     argument is provided the enclosing group for the active item is\n *     returned, unless the item it itself a group, in which case it is\n *     returned directly.\n *   xy - Returns a two-element array containing the x and y coordinates for\n *     mouse or touch events. For touch events, this is based on the first\n *     elements in the changedTouches array. This method accepts a single\n *     argument: either an item instance or mark name that should serve as\n *     the reference coordinate system. If no argument is provided the\n *     top-level view coordinate system is assumed.\n *   x - Returns the current x-coordinate, accepts the same arguments as xy.\n *   y - Returns the current y-coordinate, accepts the same arguments as xy.\n * @param {Event} event - The input event to extend.\n * @param {Item} item - The currently active scenegraph item (if any).\n * @return {Event} - The extended input event.\n */\n\nfunction eventExtend (view, event, item) {\n  var r = view._renderer,\n      el = r && r.canvas(),\n      p,\n      e,\n      translate;\n\n  if (el) {\n    translate = offset(view);\n    e = event.changedTouches ? event.changedTouches[0] : event;\n    p = point(e, el);\n    p[0] -= translate[0];\n    p[1] -= translate[1];\n  }\n\n  event.dataflow = view;\n  event.item = item;\n  event.vega = extension(view, item, p);\n  return event;\n}\n\nfunction extension(view, item, point) {\n  const itemGroup = item ? item.mark.marktype === 'group' ? item : item.mark.group : null;\n\n  function group(name) {\n    var g = itemGroup,\n        i;\n    if (name) for (i = item; i; i = i.mark.group) {\n      if (i.mark.name === name) {\n        g = i;\n        break;\n      }\n    }\n    return g && g.mark && g.mark.interactive ? g : {};\n  }\n\n  function xy(item) {\n    if (!item) return point;\n    if (isString(item)) item = group(item);\n    const p = point.slice();\n\n    while (item) {\n      p[0] -= item.x || 0;\n      p[1] -= item.y || 0;\n      item = item.mark && item.mark.group;\n    }\n\n    return p;\n  }\n\n  return {\n    view: constant(view),\n    item: constant(item || {}),\n    group: group,\n    xy: xy,\n    x: item => xy(item)[0],\n    y: item => xy(item)[1]\n  };\n}\n\nconst VIEW = 'view',\n      TIMER = 'timer',\n      WINDOW = 'window',\n      NO_TRAP = {\n  trap: false\n};\n/**\n * Initialize event handling configuration.\n * @param {object} config - The configuration settings.\n * @return {object}\n */\n\nfunction initializeEventConfig(config) {\n  const events = extend({\n    defaults: {}\n  }, config);\n\n  const unpack = (obj, keys) => {\n    keys.forEach(k => {\n      if (isArray(obj[k])) obj[k] = toSet(obj[k]);\n    });\n  };\n\n  unpack(events.defaults, ['prevent', 'allow']);\n  unpack(events, ['view', 'window', 'selector']);\n  return events;\n}\nfunction trackEventListener(view, sources, type, handler) {\n  view._eventListeners.push({\n    type: type,\n    sources: array(sources),\n    handler: handler\n  });\n}\n\nfunction prevent(view, type) {\n  var def = view._eventConfig.defaults,\n      prevent = def.prevent,\n      allow = def.allow;\n  return prevent === false || allow === true ? false : prevent === true || allow === false ? true : prevent ? prevent[type] : allow ? !allow[type] : view.preventDefault();\n}\n\nfunction permit(view, key, type) {\n  const rule = view._eventConfig && view._eventConfig[key];\n\n  if (rule === false || isObject(rule) && !rule[type]) {\n    view.warn(\"Blocked \".concat(key, \" \").concat(type, \" event listener.\"));\n    return false;\n  }\n\n  return true;\n}\n/**\n * Create a new event stream from an event source.\n * @param {object} source - The event source to monitor.\n * @param {string} type - The event type.\n * @param {function(object): boolean} [filter] - Event filter function.\n * @return {EventStream}\n */\n\n\nfunction events(source, type, filter) {\n  var view = this,\n      s = new EventStream(filter),\n      send = function (e, item) {\n    view.runAsync(null, () => {\n      if (source === VIEW && prevent(view, type)) {\n        e.preventDefault();\n      }\n\n      s.receive(eventExtend(view, e, item));\n    });\n  },\n      sources;\n\n  if (source === TIMER) {\n    if (permit(view, 'timer', type)) {\n      view.timer(send, type);\n    }\n  } else if (source === VIEW) {\n    if (permit(view, 'view', type)) {\n      // send traps errors, so use {trap: false} option\n      view.addEventListener(type, send, NO_TRAP);\n    }\n  } else {\n    if (source === WINDOW) {\n      if (permit(view, 'window', type) && typeof window !== 'undefined') {\n        sources = [window];\n      }\n    } else if (typeof document !== 'undefined') {\n      if (permit(view, 'selector', type)) {\n        sources = document.querySelectorAll(source);\n      }\n    }\n\n    if (!sources) {\n      view.warn('Can not resolve event source: ' + source);\n    } else {\n      for (var i = 0, n = sources.length; i < n; ++i) {\n        sources[i].addEventListener(type, send);\n      }\n\n      trackEventListener(view, sources, type, send);\n    }\n  }\n\n  return s;\n}\n\nfunction itemFilter(event) {\n  return event.item;\n}\n\nfunction markTarget(event) {\n  // grab upstream collector feeding the mark operator\n  return event.item.mark.source;\n}\n\nfunction invoke(name) {\n  return function (_, event) {\n    return event.vega.view().changeset().encode(event.item, name);\n  };\n}\n\nfunction hover (hoverSet, leaveSet) {\n  hoverSet = [hoverSet || 'hover'];\n  leaveSet = [leaveSet || 'update', hoverSet[0]]; // invoke hover set upon mouseover\n\n  this.on(this.events('view', 'mouseover', itemFilter), markTarget, invoke(hoverSet)); // invoke leave set upon mouseout\n\n  this.on(this.events('view', 'mouseout', itemFilter), markTarget, invoke(leaveSet));\n  return this;\n}\n\n/**\n * Finalize a View instance that is being removed.\n * Cancel any running timers.\n * Remove all external event listeners.\n * Remove any currently displayed tooltip.\n */\nfunction finalize () {\n  var tooltip = this._tooltip,\n      timers = this._timers,\n      listeners = this._eventListeners,\n      n,\n      m,\n      e;\n  n = timers.length;\n\n  while (--n >= 0) {\n    timers[n].stop();\n  }\n\n  n = listeners.length;\n\n  while (--n >= 0) {\n    e = listeners[n];\n    m = e.sources.length;\n\n    while (--m >= 0) {\n      e.sources[m].removeEventListener(e.type, e.handler);\n    }\n  }\n\n  if (tooltip) {\n    tooltip.call(this, this._handler, null, null, null);\n  }\n\n  return this;\n}\n\nfunction element (tag, attr, text) {\n  const el = document.createElement(tag);\n\n  for (const key in attr) el.setAttribute(key, attr[key]);\n\n  if (text != null) el.textContent = text;\n  return el;\n}\n\nconst BindClass = 'vega-bind',\n      NameClass = 'vega-bind-name',\n      RadioClass = 'vega-bind-radio';\n/**\n * Bind a signal to an external HTML input element. The resulting two-way\n * binding will propagate input changes to signals, and propagate signal\n * changes to the input element state. If this view instance has no parent\n * element, we assume the view is headless and no bindings are created.\n * @param {Element|string} el - The parent DOM element to which the input\n *   element should be appended as a child. If string-valued, this argument\n *   will be treated as a CSS selector. If null or undefined, the parent\n *   element of this view will be used as the element.\n * @param {object} param - The binding parameters which specify the signal\n *   to bind to, the input element type, and type-specific configuration.\n * @return {View} - This view instance.\n */\n\nfunction bind (view, el, binding) {\n  if (!el) return;\n  const param = binding.param;\n  let bind = binding.state;\n\n  if (!bind) {\n    bind = binding.state = {\n      elements: null,\n      active: false,\n      set: null,\n      update: value => {\n        if (value != view.signal(param.signal)) {\n          view.runAsync(null, () => {\n            bind.source = true;\n            view.signal(param.signal, value);\n          });\n        }\n      }\n    };\n\n    if (param.debounce) {\n      bind.update = debounce(param.debounce, bind.update);\n    }\n  }\n\n  const create = param.input == null && param.element ? target : generate;\n  create(bind, el, param, view);\n\n  if (!bind.active) {\n    view.on(view._signals[param.signal], null, () => {\n      bind.source ? bind.source = false : bind.set(view.signal(param.signal));\n    });\n    bind.active = true;\n  }\n\n  return bind;\n}\n/**\n * Bind the signal to an external EventTarget.\n */\n\nfunction target(bind, node, param, view) {\n  const type = param.event || 'input';\n\n  const handler = () => bind.update(node.value); // initialize signal value to external input value\n\n\n  view.signal(param.signal, node.value); // listen for changes on the element\n\n  node.addEventListener(type, handler); // register with view, so we can remove it upon finalization\n\n  trackEventListener(view, node, type, handler); // propagate change to element\n\n  bind.set = value => {\n    node.value = value;\n    node.dispatchEvent(event(type));\n  };\n}\n\nfunction event(type) {\n  return typeof Event !== 'undefined' ? new Event(type) : {\n    type\n  };\n}\n/**\n * Generate an HTML input form element and bind it to a signal.\n */\n\n\nfunction generate(bind, el, param, view) {\n  const value = view.signal(param.signal);\n  const div = element('div', {\n    'class': BindClass\n  });\n  const wrapper = param.input === 'radio' ? div : div.appendChild(element('label'));\n  wrapper.appendChild(element('span', {\n    'class': NameClass\n  }, param.name || param.signal));\n  el.appendChild(div);\n  let input = form;\n\n  switch (param.input) {\n    case 'checkbox':\n      input = checkbox;\n      break;\n\n    case 'select':\n      input = select;\n      break;\n\n    case 'radio':\n      input = radio;\n      break;\n\n    case 'range':\n      input = range;\n      break;\n  }\n\n  input(bind, wrapper, param, value);\n}\n/**\n * Generates an arbitrary input form element.\n * The input type is controlled via user-provided parameters.\n */\n\n\nfunction form(bind, el, param, value) {\n  const node = element('input');\n\n  for (const key in param) {\n    if (key !== 'signal' && key !== 'element') {\n      node.setAttribute(key === 'input' ? 'type' : key, param[key]);\n    }\n  }\n\n  node.setAttribute('name', param.signal);\n  node.value = value;\n  el.appendChild(node);\n  node.addEventListener('input', () => bind.update(node.value));\n  bind.elements = [node];\n\n  bind.set = value => node.value = value;\n}\n/**\n * Generates a checkbox input element.\n */\n\n\nfunction checkbox(bind, el, param, value) {\n  const attr = {\n    type: 'checkbox',\n    name: param.signal\n  };\n  if (value) attr.checked = true;\n  const node = element('input', attr);\n  el.appendChild(node);\n  node.addEventListener('change', () => bind.update(node.checked));\n  bind.elements = [node];\n\n  bind.set = value => node.checked = !!value || null;\n}\n/**\n * Generates a selection list input element.\n */\n\n\nfunction select(bind, el, param, value) {\n  const node = element('select', {\n    name: param.signal\n  }),\n        labels = param.labels || [];\n  param.options.forEach((option, i) => {\n    const attr = {\n      value: option\n    };\n    if (valuesEqual(option, value)) attr.selected = true;\n    node.appendChild(element('option', attr, (labels[i] || option) + ''));\n  });\n  el.appendChild(node);\n  node.addEventListener('change', () => {\n    bind.update(param.options[node.selectedIndex]);\n  });\n  bind.elements = [node];\n\n  bind.set = value => {\n    for (let i = 0, n = param.options.length; i < n; ++i) {\n      if (valuesEqual(param.options[i], value)) {\n        node.selectedIndex = i;\n        return;\n      }\n    }\n  };\n}\n/**\n * Generates a radio button group.\n */\n\n\nfunction radio(bind, el, param, value) {\n  const group = element('span', {\n    'class': RadioClass\n  }),\n        labels = param.labels || [];\n  el.appendChild(group);\n  bind.elements = param.options.map((option, i) => {\n    const attr = {\n      type: 'radio',\n      name: param.signal,\n      value: option\n    };\n    if (valuesEqual(option, value)) attr.checked = true;\n    const input = element('input', attr);\n    input.addEventListener('change', () => bind.update(option));\n    const label = element('label', {}, (labels[i] || option) + '');\n    label.prepend(input);\n    group.appendChild(label);\n    return input;\n  });\n\n  bind.set = value => {\n    const nodes = bind.elements,\n          n = nodes.length;\n\n    for (let i = 0; i < n; ++i) {\n      if (valuesEqual(nodes[i].value, value)) nodes[i].checked = true;\n    }\n  };\n}\n/**\n * Generates a slider input element.\n */\n\n\nfunction range(bind, el, param, value) {\n  value = value !== undefined ? value : (+param.max + +param.min) / 2;\n  const max = param.max != null ? param.max : Math.max(100, +value) || 100,\n        min = param.min || Math.min(0, max, +value) || 0,\n        step = param.step || tickStep(min, max, 100);\n  const node = element('input', {\n    type: 'range',\n    name: param.signal,\n    min: min,\n    max: max,\n    step: step\n  });\n  node.value = value;\n  const span = element('span', {}, +value);\n  el.appendChild(node);\n  el.appendChild(span);\n\n  const update = () => {\n    span.textContent = node.value;\n    bind.update(+node.value);\n  }; // subscribe to both input and change\n\n\n  node.addEventListener('input', update);\n  node.addEventListener('change', update);\n  bind.elements = [node];\n\n  bind.set = value => {\n    node.value = value;\n    span.textContent = value;\n  };\n}\n\nfunction valuesEqual(a, b) {\n  return a === b || a + '' === b + '';\n}\n\nfunction initializeRenderer (view, r, el, constructor, scaleFactor, opt) {\n  r = r || new constructor(view.loader());\n  return r.initialize(el, width(view), height(view), offset(view), scaleFactor, opt).background(view.background());\n}\n\nfunction trap (view, fn) {\n  return !fn ? null : function () {\n    try {\n      fn.apply(this, arguments);\n    } catch (error) {\n      view.error(error);\n    }\n  };\n}\n\nfunction initializeHandler (view, prevHandler, el, constructor) {\n  // instantiate scenegraph handler\n  const handler = new constructor(view.loader(), trap(view, view.tooltip())).scene(view.scenegraph().root).initialize(el, offset(view), view); // transfer event handlers\n\n  if (prevHandler) {\n    prevHandler.handlers().forEach(h => {\n      handler.on(h.type, h.handler);\n    });\n  }\n\n  return handler;\n}\n\nfunction initialize (el, elBind) {\n  const view = this,\n        type = view._renderType,\n        config = view._eventConfig.bind,\n        module = renderModule(type); // containing dom element\n\n  el = view._el = el ? lookup(view, el, true) : null; // initialize aria attributes\n\n  initializeAria(view); // select appropriate renderer & handler\n\n  if (!module) view.error('Unrecognized renderer type: ' + type);\n  const Handler = module.handler || CanvasHandler,\n        Renderer = el ? module.renderer : module.headless; // initialize renderer and input handler\n\n  view._renderer = !Renderer ? null : initializeRenderer(view, view._renderer, el, Renderer);\n  view._handler = initializeHandler(view, view._handler, el, Handler);\n  view._redraw = true; // initialize signal bindings\n\n  if (el && config !== 'none') {\n    elBind = elBind ? view._elBind = lookup(view, elBind, true) : el.appendChild(element('form', {\n      'class': 'vega-bindings'\n    }));\n\n    view._bind.forEach(_ => {\n      if (_.param.element && config !== 'container') {\n        _.element = lookup(view, _.param.element, !!_.param.input);\n      }\n    });\n\n    view._bind.forEach(_ => {\n      bind(view, _.element || elBind, _);\n    });\n  }\n\n  return view;\n}\n\nfunction lookup(view, el, clear) {\n  if (typeof el === 'string') {\n    if (typeof document !== 'undefined') {\n      el = document.querySelector(el);\n\n      if (!el) {\n        view.error('Signal bind element not found: ' + el);\n        return null;\n      }\n    } else {\n      view.error('DOM document instance not found.');\n      return null;\n    }\n  }\n\n  if (el && clear) {\n    try {\n      el.textContent = '';\n    } catch (e) {\n      el = null;\n      view.error(e);\n    }\n  }\n\n  return el;\n}\n\nconst number = _ => +_ || 0;\n\nconst paddingObject = _ => ({\n  top: _,\n  bottom: _,\n  left: _,\n  right: _\n});\n\nfunction padding (_) {\n  return isObject(_) ? {\n    top: number(_.top),\n    bottom: number(_.bottom),\n    left: number(_.left),\n    right: number(_.right)\n  } : paddingObject(number(_));\n}\n\n/**\n * Render the current scene in a headless fashion.\n * This method is asynchronous, returning a Promise instance.\n * @return {Promise} - A Promise that resolves to a renderer.\n */\n\nasync function renderHeadless (view, type, scaleFactor, opt) {\n  const module = renderModule(type),\n        ctr = module && module.headless;\n  if (!ctr) error('Unrecognized renderer type: ' + type);\n  await view.runAsync();\n  return initializeRenderer(view, null, null, ctr, scaleFactor, opt).renderAsync(view._scenegraph.root);\n}\n\n/**\n * Produce an image URL for the visualization. Depending on the type\n * parameter, the generated URL contains data for either a PNG or SVG image.\n * The URL can be used (for example) to download images of the visualization.\n * This method is asynchronous, returning a Promise instance.\n * @param {string} type - The image type. One of 'svg', 'png' or 'canvas'.\n *   The 'canvas' and 'png' types are synonyms for a PNG image.\n * @return {Promise} - A promise that resolves to an image URL.\n */\n\nasync function renderToImageURL (type, scaleFactor) {\n  if (type !== RenderType.Canvas && type !== RenderType.SVG && type !== RenderType.PNG) {\n    error('Unrecognized image type: ' + type);\n  }\n\n  const r = await renderHeadless(this, type, scaleFactor);\n  return type === RenderType.SVG ? toBlobURL(r.svg(), 'image/svg+xml') : r.canvas().toDataURL('image/png');\n}\n\nfunction toBlobURL(data, mime) {\n  const blob = new Blob([data], {\n    type: mime\n  });\n  return window.URL.createObjectURL(blob);\n}\n\n/**\n * Produce a Canvas instance containing a rendered visualization.\n * This method is asynchronous, returning a Promise instance.\n * @return {Promise} - A promise that resolves to a Canvas instance.\n */\n\nasync function renderToCanvas (scaleFactor, opt) {\n  const r = await renderHeadless(this, RenderType.Canvas, scaleFactor, opt);\n  return r.canvas();\n}\n\n/**\n * Produce a rendered SVG string of the visualization.\n * This method is asynchronous, returning a Promise instance.\n * @return {Promise} - A promise that resolves to an SVG string.\n */\n\nasync function renderToSVG (scaleFactor) {\n  const r = await renderHeadless(this, RenderType.SVG, scaleFactor);\n  return r.svg();\n}\n\nfunction runtime (view, spec, expr) {\n  return context(view, transforms, functionContext, expr).parse(spec);\n}\n\nfunction scale(name) {\n  var scales = this._runtime.scales;\n\n  if (!hasOwnProperty(scales, name)) {\n    error('Unrecognized scale or projection: ' + name);\n  }\n\n  return scales[name].value;\n}\n\nvar Width = 'width',\n    Height = 'height',\n    Padding = 'padding',\n    Skip = {\n  skip: true\n};\nfunction viewWidth(view, width) {\n  var a = view.autosize(),\n      p = view.padding();\n  return width - (a && a.contains === Padding ? p.left + p.right : 0);\n}\nfunction viewHeight(view, height) {\n  var a = view.autosize(),\n      p = view.padding();\n  return height - (a && a.contains === Padding ? p.top + p.bottom : 0);\n}\nfunction initializeResize(view) {\n  var s = view._signals,\n      w = s[Width],\n      h = s[Height],\n      p = s[Padding];\n\n  function resetSize() {\n    view._autosize = view._resize = 1;\n  } // respond to width signal\n\n\n  view._resizeWidth = view.add(null, _ => {\n    view._width = _.size;\n    view._viewWidth = viewWidth(view, _.size);\n    resetSize();\n  }, {\n    size: w\n  }); // respond to height signal\n\n  view._resizeHeight = view.add(null, _ => {\n    view._height = _.size;\n    view._viewHeight = viewHeight(view, _.size);\n    resetSize();\n  }, {\n    size: h\n  }); // respond to padding signal\n\n  const resizePadding = view.add(null, resetSize, {\n    pad: p\n  }); // set rank to run immediately after source signal\n\n  view._resizeWidth.rank = w.rank + 1;\n  view._resizeHeight.rank = h.rank + 1;\n  resizePadding.rank = p.rank + 1;\n}\nfunction resizeView(viewWidth, viewHeight, width, height, origin, auto) {\n  this.runAfter(view => {\n    let rerun = 0; // reset autosize flag\n\n    view._autosize = 0; // width value changed: update signal, skip resize op\n\n    if (view.width() !== width) {\n      rerun = 1;\n      view.signal(Width, width, Skip); // set width, skip update calc\n\n      view._resizeWidth.skip(true); // skip width resize handler\n\n    } // height value changed: update signal, skip resize op\n\n\n    if (view.height() !== height) {\n      rerun = 1;\n      view.signal(Height, height, Skip); // set height, skip update calc\n\n      view._resizeHeight.skip(true); // skip height resize handler\n\n    } // view width changed: update view property, set resize flag\n\n\n    if (view._viewWidth !== viewWidth) {\n      view._resize = 1;\n      view._viewWidth = viewWidth;\n    } // view height changed: update view property, set resize flag\n\n\n    if (view._viewHeight !== viewHeight) {\n      view._resize = 1;\n      view._viewHeight = viewHeight;\n    } // origin changed: update view property, set resize flag\n\n\n    if (view._origin[0] !== origin[0] || view._origin[1] !== origin[1]) {\n      view._resize = 1;\n      view._origin = origin;\n    } // run dataflow on width/height signal change\n\n\n    if (rerun) view.run('enter');\n    if (auto) view.runAfter(v => v.resize());\n  }, false, 1);\n}\n\n/**\n * Get the current view state, consisting of signal values and/or data sets.\n * @param {object} [options] - Options flags indicating which state to export.\n *   If unspecified, all signals and data sets will be exported.\n * @param {function(string, Operator):boolean} [options.signals] - Optional\n *   predicate function for testing if a signal should be included in the\n *   exported state. If unspecified, all signals will be included, except for\n *   those named 'parent' or those which refer to a Transform value.\n * @param {function(string, object):boolean} [options.data] - Optional\n *   predicate function for testing if a data set's input should be included\n *   in the exported state. If unspecified, all data sets that have been\n *   explicitly modified will be included.\n * @param {boolean} [options.recurse=true] - Flag indicating if the exported\n *   state should recursively include state from group mark sub-contexts.\n * @return {object} - An object containing the exported state values.\n */\n\nfunction getState(options) {\n  return this._runtime.getState(options || {\n    data: dataTest,\n    signals: signalTest,\n    recurse: true\n  });\n}\n\nfunction dataTest(name, data) {\n  return data.modified && isArray(data.input.value) && name.indexOf('_:vega:_');\n}\n\nfunction signalTest(name, op) {\n  return !(name === 'parent' || op instanceof transforms.proxy);\n}\n/**\n * Sets the current view state and updates the view by invoking run.\n * @param {object} state - A state object containing signal and/or\n *   data set values, following the format used by the getState method.\n * @return {View} - This view instance.\n */\n\n\nfunction setState(state) {\n  this.runAsync(null, v => {\n    v._trigger = false;\n\n    v._runtime.setState(state);\n  }, v => {\n    v._trigger = true;\n  });\n  return this;\n}\n\nfunction timer (callback, delay) {\n  function tick(elapsed) {\n    callback({\n      timestamp: Date.now(),\n      elapsed: elapsed\n    });\n  }\n\n  this._timers.push(interval(tick, delay));\n}\n\nfunction defaultTooltip (handler, event, item, value) {\n  const el = handler.element();\n  if (el) el.setAttribute('title', formatTooltip(value));\n}\n\nfunction formatTooltip(value) {\n  return value == null ? '' : isArray(value) ? formatArray(value) : isObject(value) && !isDate(value) ? formatObject(value) : value + '';\n}\n\nfunction formatObject(obj) {\n  return Object.keys(obj).map(key => {\n    const v = obj[key];\n    return key + ': ' + (isArray(v) ? formatArray(v) : formatValue(v));\n  }).join('\\n');\n}\n\nfunction formatArray(value) {\n  return '[' + value.map(formatValue).join(', ') + ']';\n}\n\nfunction formatValue(value) {\n  return isArray(value) ? '[\\u2026]' : isObject(value) && !isDate(value) ? '{\\u2026}' : value;\n}\n\n/**\n * Create a new View instance from a Vega dataflow runtime specification.\n * The generated View will not immediately be ready for display. Callers\n * should also invoke the initialize method (e.g., to set the parent\n * DOM element in browser-based deployment) and then invoke the run\n * method to evaluate the dataflow graph. Rendering will automatically\n * be performed upon dataflow runs.\n * @constructor\n * @param {object} spec - The Vega dataflow runtime specification.\n */\n\nfunction View(spec, options) {\n  const view = this;\n  options = options || {};\n  Dataflow.call(view);\n  if (options.loader) view.loader(options.loader);\n  if (options.logger) view.logger(options.logger);\n  if (options.logLevel != null) view.logLevel(options.logLevel);\n\n  if (options.locale || spec.locale) {\n    const loc = extend({}, spec.locale, options.locale);\n    view.locale(locale(loc.number, loc.time));\n  }\n\n  view._el = null;\n  view._elBind = null;\n  view._renderType = options.renderer || RenderType.Canvas;\n  view._scenegraph = new Scenegraph();\n  const root = view._scenegraph.root; // initialize renderer, handler and event management\n\n  view._renderer = null;\n  view._tooltip = options.tooltip || defaultTooltip, view._redraw = true;\n  view._handler = new CanvasHandler().scene(root);\n  view._globalCursor = false;\n  view._preventDefault = false;\n  view._timers = [];\n  view._eventListeners = [];\n  view._resizeListeners = []; // initialize event configuration\n\n  view._eventConfig = initializeEventConfig(spec.eventConfig);\n  view.globalCursor(view._eventConfig.globalCursor); // initialize dataflow graph\n\n  const ctx = runtime(view, spec, options.expr);\n  view._runtime = ctx;\n  view._signals = ctx.signals;\n  view._bind = (spec.bindings || []).map(_ => ({\n    state: null,\n    param: extend({}, _)\n  })); // initialize scenegraph\n\n  if (ctx.root) ctx.root.set(root);\n  root.source = ctx.data.root.input;\n  view.pulse(ctx.data.root.input, view.changeset().insert(root.items)); // initialize view size\n\n  view._width = view.width();\n  view._height = view.height();\n  view._viewWidth = viewWidth(view, view._width);\n  view._viewHeight = viewHeight(view, view._height);\n  view._origin = [0, 0];\n  view._resize = 0;\n  view._autosize = 1;\n  initializeResize(view); // initialize background color\n\n  background(view); // initialize cursor\n\n  cursor(view); // initialize view description\n\n  view.description(spec.description); // initialize hover proessing, if requested\n\n  if (options.hover) view.hover(); // initialize DOM container(s) and renderer\n\n  if (options.container) view.initialize(options.container, options.bind);\n}\n\nfunction lookupSignal(view, name) {\n  return hasOwnProperty(view._signals, name) ? view._signals[name] : error('Unrecognized signal name: ' + stringValue(name));\n}\n\nfunction findOperatorHandler(op, handler) {\n  const h = (op._targets || []).filter(op => op._update && op._update.handler === handler);\n  return h.length ? h[0] : null;\n}\n\nfunction addOperatorListener(view, name, op, handler) {\n  let h = findOperatorHandler(op, handler);\n\n  if (!h) {\n    h = trap(view, () => handler(name, op.value));\n    h.handler = handler;\n    view.on(op, null, h);\n  }\n\n  return view;\n}\n\nfunction removeOperatorListener(view, op, handler) {\n  const h = findOperatorHandler(op, handler);\n  if (h) op._targets.remove(h);\n  return view;\n}\n\ninherits(View, Dataflow, {\n  // -- DATAFLOW / RENDERING ----\n  async evaluate(encode, prerun, postrun) {\n    // evaluate dataflow and prerun\n    await Dataflow.prototype.evaluate.call(this, encode, prerun); // render as needed\n\n    if (this._redraw || this._resize) {\n      try {\n        if (this._renderer) {\n          if (this._resize) {\n            this._resize = 0;\n            resizeRenderer(this);\n          }\n\n          await this._renderer.renderAsync(this._scenegraph.root);\n        }\n\n        this._redraw = false;\n      } catch (e) {\n        this.error(e);\n      }\n    } // evaluate postrun\n\n\n    if (postrun) asyncCallback(this, postrun);\n    return this;\n  },\n\n  dirty(item) {\n    this._redraw = true;\n    this._renderer && this._renderer.dirty(item);\n  },\n\n  // -- GET / SET ----\n  description(text) {\n    if (arguments.length) {\n      const desc = text != null ? text + '' : null;\n      if (desc !== this._desc) ariaLabel(this._el, this._desc = desc);\n      return this;\n    }\n\n    return this._desc;\n  },\n\n  container() {\n    return this._el;\n  },\n\n  scenegraph() {\n    return this._scenegraph;\n  },\n\n  origin() {\n    return this._origin.slice();\n  },\n\n  signal(name, value, options) {\n    const op = lookupSignal(this, name);\n    return arguments.length === 1 ? op.value : this.update(op, value, options);\n  },\n\n  width(_) {\n    return arguments.length ? this.signal('width', _) : this.signal('width');\n  },\n\n  height(_) {\n    return arguments.length ? this.signal('height', _) : this.signal('height');\n  },\n\n  padding(_) {\n    return arguments.length ? this.signal('padding', padding(_)) : padding(this.signal('padding'));\n  },\n\n  autosize(_) {\n    return arguments.length ? this.signal('autosize', _) : this.signal('autosize');\n  },\n\n  background(_) {\n    return arguments.length ? this.signal('background', _) : this.signal('background');\n  },\n\n  renderer(type) {\n    if (!arguments.length) return this._renderType;\n    if (!renderModule(type)) error('Unrecognized renderer type: ' + type);\n\n    if (type !== this._renderType) {\n      this._renderType = type;\n\n      this._resetRenderer();\n    }\n\n    return this;\n  },\n\n  tooltip(handler) {\n    if (!arguments.length) return this._tooltip;\n\n    if (handler !== this._tooltip) {\n      this._tooltip = handler;\n\n      this._resetRenderer();\n    }\n\n    return this;\n  },\n\n  loader(loader) {\n    if (!arguments.length) return this._loader;\n\n    if (loader !== this._loader) {\n      Dataflow.prototype.loader.call(this, loader);\n\n      this._resetRenderer();\n    }\n\n    return this;\n  },\n\n  resize() {\n    // set flag to perform autosize\n    this._autosize = 1; // touch autosize signal to ensure top-level ViewLayout runs\n\n    return this.touch(lookupSignal(this, 'autosize'));\n  },\n\n  _resetRenderer() {\n    if (this._renderer) {\n      this._renderer = null;\n      this.initialize(this._el, this._elBind);\n    }\n  },\n\n  // -- SIZING ----\n  _resizeView: resizeView,\n\n  // -- EVENT HANDLING ----\n  addEventListener(type, handler, options) {\n    let callback = handler;\n\n    if (!(options && options.trap === false)) {\n      // wrap callback in error handler\n      callback = trap(this, handler);\n      callback.raw = handler;\n    }\n\n    this._handler.on(type, callback);\n\n    return this;\n  },\n\n  removeEventListener(type, handler) {\n    var handlers = this._handler.handlers(type),\n        i = handlers.length,\n        h,\n        t; // search registered handlers, remove if match found\n\n\n    while (--i >= 0) {\n      t = handlers[i].type;\n      h = handlers[i].handler;\n\n      if (type === t && (handler === h || handler === h.raw)) {\n        this._handler.off(t, h);\n\n        break;\n      }\n    }\n\n    return this;\n  },\n\n  addResizeListener(handler) {\n    const l = this._resizeListeners;\n\n    if (l.indexOf(handler) < 0) {\n      // add handler if it isn't already registered\n      // note: error trapping handled elsewhere, so\n      // no need to wrap handlers here\n      l.push(handler);\n    }\n\n    return this;\n  },\n\n  removeResizeListener(handler) {\n    var l = this._resizeListeners,\n        i = l.indexOf(handler);\n\n    if (i >= 0) {\n      l.splice(i, 1);\n    }\n\n    return this;\n  },\n\n  addSignalListener(name, handler) {\n    return addOperatorListener(this, name, lookupSignal(this, name), handler);\n  },\n\n  removeSignalListener(name, handler) {\n    return removeOperatorListener(this, lookupSignal(this, name), handler);\n  },\n\n  addDataListener(name, handler) {\n    return addOperatorListener(this, name, dataref(this, name).values, handler);\n  },\n\n  removeDataListener(name, handler) {\n    return removeOperatorListener(this, dataref(this, name).values, handler);\n  },\n\n  globalCursor(_) {\n    if (arguments.length) {\n      if (this._globalCursor !== !!_) {\n        const prev = setCursor(this, null); // clear previous cursor\n\n        this._globalCursor = !!_;\n        if (prev) setCursor(this, prev); // swap cursor\n      }\n\n      return this;\n    } else {\n      return this._globalCursor;\n    }\n  },\n\n  preventDefault(_) {\n    if (arguments.length) {\n      this._preventDefault = _;\n      return this;\n    } else {\n      return this._preventDefault;\n    }\n  },\n\n  timer,\n  events,\n  finalize,\n  hover,\n  // -- DATA ----\n  data,\n  change,\n  insert,\n  remove,\n  // -- SCALES --\n  scale,\n  // -- INITIALIZATION ----\n  initialize,\n  // -- HEADLESS RENDERING ----\n  toImageURL: renderToImageURL,\n  toCanvas: renderToCanvas,\n  toSVG: renderToSVG,\n  // -- SAVE / RESTORE STATE ----\n  getState,\n  setState\n});\n\nexport { View };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}