{"ast":null,"code":"import { Transform } from 'vega-dataflow';\nimport { inherits } from 'vega-util';\nimport { Delaunay } from 'd3-delaunay';\nfunction Voronoi(params) {\n  Transform.call(this, null, params);\n}\nVoronoi.Definition = {\n  'type': 'Voronoi',\n  'metadata': {\n    'modifies': true\n  },\n  'params': [{\n    'name': 'x',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'y',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'size',\n    'type': 'number',\n    'array': true,\n    'length': 2\n  }, {\n    'name': 'extent',\n    'type': 'array',\n    'array': true,\n    'length': 2,\n    'default': [[-1e5, -1e5], [1e5, 1e5]],\n    'content': {\n      'type': 'number',\n      'array': true,\n      'length': 2\n    }\n  }, {\n    'name': 'as',\n    'type': 'string',\n    'default': 'path'\n  }]\n};\nvar defaultExtent = [-1e5, -1e5, 1e5, 1e5];\ninherits(Voronoi, Transform, {\n  transform: function transform(_, pulse) {\n    var as = _.as || 'path',\n      data = pulse.source; // nothing to do if no data\n\n    if (!data || !data.length) return pulse; // configure and construct voronoi diagram\n\n    var s = _.size;\n    s = s ? [0, 0, s[0], s[1]] : (s = _.extent) ? [s[0][0], s[0][1], s[1][0], s[1][1]] : defaultExtent;\n    var voronoi = this.value = Delaunay.from(data, _.x, _.y).voronoi(s); // map polygons to paths\n\n    for (var i = 0, n = data.length; i < n; ++i) {\n      var polygon = voronoi.cellPolygon(i);\n      data[i][as] = polygon ? toPathString(polygon) : null;\n    }\n    return pulse.reflow(_.modified()).modifies(as);\n  }\n}); // suppress duplicated end point vertices\n\nfunction toPathString(p) {\n  var x = p[0][0],\n    y = p[0][1];\n  var n = p.length - 1;\n  for (; p[n][0] === x && p[n][1] === y; --n) {\n    ;\n  }\n  return 'M' + p.slice(0, n + 1).join('L') + 'Z';\n}\nexport { Voronoi as voronoi };","map":{"version":3,"names":["Transform","inherits","Delaunay","Voronoi","params","call","Definition","defaultExtent","transform","_","pulse","as","data","source","length","s","size","extent","voronoi","value","from","x","y","i","n","polygon","cellPolygon","toPathString","reflow","modified","modifies","p","slice","join"],"sources":["/Users/weihangzhang/Documents/webpage/visualization-app/node_modules/vega-voronoi/build/vega-voronoi.module.js"],"sourcesContent":["import { Transform } from 'vega-dataflow';\nimport { inherits } from 'vega-util';\nimport { Delaunay } from 'd3-delaunay';\n\nfunction Voronoi(params) {\n  Transform.call(this, null, params);\n}\nVoronoi.Definition = {\n  'type': 'Voronoi',\n  'metadata': {\n    'modifies': true\n  },\n  'params': [{\n    'name': 'x',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'y',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'size',\n    'type': 'number',\n    'array': true,\n    'length': 2\n  }, {\n    'name': 'extent',\n    'type': 'array',\n    'array': true,\n    'length': 2,\n    'default': [[-1e5, -1e5], [1e5, 1e5]],\n    'content': {\n      'type': 'number',\n      'array': true,\n      'length': 2\n    }\n  }, {\n    'name': 'as',\n    'type': 'string',\n    'default': 'path'\n  }]\n};\nconst defaultExtent = [-1e5, -1e5, 1e5, 1e5];\ninherits(Voronoi, Transform, {\n  transform(_, pulse) {\n    const as = _.as || 'path',\n          data = pulse.source; // nothing to do if no data\n\n    if (!data || !data.length) return pulse; // configure and construct voronoi diagram\n\n    let s = _.size;\n    s = s ? [0, 0, s[0], s[1]] : (s = _.extent) ? [s[0][0], s[0][1], s[1][0], s[1][1]] : defaultExtent;\n    const voronoi = this.value = Delaunay.from(data, _.x, _.y).voronoi(s); // map polygons to paths\n\n    for (let i = 0, n = data.length; i < n; ++i) {\n      const polygon = voronoi.cellPolygon(i);\n      data[i][as] = polygon ? toPathString(polygon) : null;\n    }\n\n    return pulse.reflow(_.modified()).modifies(as);\n  }\n\n}); // suppress duplicated end point vertices\n\nfunction toPathString(p) {\n  const x = p[0][0],\n        y = p[0][1];\n  let n = p.length - 1;\n\n  for (; p[n][0] === x && p[n][1] === y; --n);\n\n  return 'M' + p.slice(0, n + 1).join('L') + 'Z';\n}\n\nexport { Voronoi as voronoi };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}